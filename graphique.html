<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Calculatrice graphique Lebbar</title>
  <style>
    body {
      background: #121212;
      color: white;
      font-family: Arial;
      text-align: center;
    }
    input, button {
      padding: 10px;
      font-size: 16px;
      margin: 5px;
    }
    canvas {
      background: #fff;
      border: 1px solid #ccc;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <h1>ðŸ“ˆ Calculatrice graphique Lebbar</h1>

  <input type="text" id="equation" placeholder="Ex: x^2 ou sin(x)">
  <input type="number" id="xvalue" placeholder="Valeur de x ?" step="any">
  <button onclick="draw()">Tracer</button>

  <p id="result"></p>
  <canvas id="graph" width="600" height="400"></canvas>
<script>
  function parseExpr(expr, x) {
    expr = expr.replace(/\^/g, "**");
    expr = expr.replace(/sin/g, "Math.sin")
               .replace(/cos/g, "Math.cos")
               .replace(/tan/g, "Math.tan");
    return eval(expr.replace(/x/g, `(${x})`));
  }

  function draw() {
    const canvas = document.getElementById('graph');
    const ctx = canvas.getContext('2d');
    const expr = document.getElementById('equation').value;
    const xval = parseFloat(document.getElementById('xvalue').value);
    const resultBox = document.getElementById('result');

    ctx.clearRect(0, 0, canvas.width, canvas.height);

    const scale = 30;
    const originX = canvas.width / 2;
    const originY = canvas.height / 2;

    // Axes
    ctx.strokeStyle = "#888";
    ctx.beginPath();
    ctx.moveTo(0, originY);
    ctx.lineTo(canvas.width, originY);
    ctx.moveTo(originX, 0);
    ctx.lineTo(originX, canvas.height);
    ctx.stroke();

    // Nombres sur les axes
    ctx.fillStyle = "#000";
    ctx.font = "12px Arial";
    for (let i = -9; i <= 9; i++) {
      if (i !== 0) {
        ctx.fillText(i, originX + i * scale - 5, originY + 15); // X
        ctx.fillText(i, originX + 5, originY - i * scale + 5); // Y
      }
    }

    // Courbe en noir
    ctx.strokeStyle = "#000";
    ctx.beginPath();
    let started = false;
    for (let px = 0; px < canvas.width; px++) {
      let x = (px - originX) / scale;
      let y;
      try {
        y = parseExpr(expr, x);
      } catch {
        y = NaN;
      }
      if (!isNaN(y) && Math.abs(y) < 100) {
        let py = originY - y * scale;
        if (!started) {
          ctx.moveTo(px, py);
          started = true;
        } else {
          ctx.lineTo(px, py);
        }
      } else {
        started = false; // coupe la ligne si y est invalide
      }
    }
    ctx.stroke();

    // RÃ©sultat pour x choisi
    if (!isNaN(xval)) {
      try {
        const yval = parseExpr(expr, xval);
        resultBox.innerHTML = `ðŸ“ RÃ©sultat : ${yval.toFixed(4)}`;
      } catch {
        resultBox.innerHTML = `âŒ Erreur dans l'expression`;
      }
    } else {
      resultBox.innerHTML = `â„¹ï¸ Tape une valeur de x pour calculer`;
    }
  }

  /* Style par dÃ©faut (mobile) */
.graph-calc {
  width: 100%;
  max-width: 360px;   /* limite comme un tÃ©lÃ©phone */
  margin: 20px auto;
  background: #fff;
  border-radius: 12px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
  padding: 20px;
}

/* Version PC (grand Ã©cran) */
@media (min-width: 768px) {
  .graph-calc {
    max-width: 900px;   /* beaucoup plus large */
    height: 600px;      /* espace pour le graphe */
  }
}

</script>
</body>
</html>

